rm(list=ls())
##install.packages("HGDP.CEPH", repos="https://genostats.github.io/R/")
require(HGDP.CEPH)
# lire données
filepath <-system.file("extdata", "hgdp_ceph.bed", package="HGDP.CEPH")
x <- read.bed.matrix(filepath)
# données SNP et individus
head( x@snps )
head( x@ped )
# comment les régions sont recodées en 7 grandes régions
table(x@ped$region, x@ped$region7)
# ajouter callrate, maf, etc
x <- set.stats(x)
# virer SNPs rares et non-autosomaux
x <- select.snps(x, maf > 0.05 & is.autosome(chr))
# calcul matrice de corrélation inter individus
K.x <- GRM(x)
# eigen decomposition
eigen.K.x <- eigen(K.x)
dim(eigen.K.x$vectors)
# ébouli des valeurs propres
plot( eigen.K.x$values)
# % variance 4 premières PCs
cumsum( eigen.K.x$values)[2]/sum(eigen.K.x$values)
# deux premières PCs + régions
plot( eigen.K.x$vectors, col = x@ped$region7)
?eingen
?eigen
head( x@ped )
# comment les régions sont recodées en 7 grandes régions
table(x@ped$region, x@ped$region7)
# eigen decomposition
eigen.K.x <- eigen(K.x)
rm(list=ls())
##install.packages("HGDP.CEPH", repos="https://genostats.github.io/R/")
require(HGDP.CEPH)
require(VarSelLCM)
# lire données
filepath <-system.file("extdata", "hgdp_ceph.bed", package="HGDP.CEPH")
x <- read.bed.matrix(filepath)
# données SNP et individus
head( x@snps )
head( x@ped )
# comment les régions sont recodées en 7 grandes régions
table(x@ped$region, x@ped$region7)
# ajouter callrate, maf, etc
x <- set.stats(x)
# virer SNPs rares et non-autosomaux
x <- select.snps(x, maf > 0.05 & is.autosome(chr))
# calcul matrice de corrélation inter individus
K.x = GRM(x)
# eigen decomposition
eigen.K.x <- eigen(K.x)
# ébouli des valeurs propres
plot( eigen.K.x$values)
km.acp <- kmeans(eigen.K.x$vectors[,1:2], centers=d, nstart=500)
km.acp <- kmeans(eigen.K.x$vectors[,1:2], centers=7, nstart=500)
table(km.acp$cluster, x@ped$region7)
ARI(km.acp$cluster, x@ped$region7)
km.acp <- kmeans(eigen.K.x$vectors[,1:2], centers=7, nstart=500)
table(km.acp$cluster, x@ped$region7)
ARI(km.acp$cluster, x@ped$region7)
# clustering spectral
W = sqrt(pmax((K.x%*%t(K.x)),0))
km.acp <- kmeans(eigen.K.x$vectors[,1:3], centers=7, nstart=500)
table(km.acp$cluster, x@ped$region7)
ARI(km.acp$cluster, x@ped$region7)
km.acp <- kmeans(eigen.K.x$vectors[,1:2], centers=7, nstart=500)
table(km.acp$cluster, x@ped$region7)
ARI(km.acp$cluster, x@ped$region7)
